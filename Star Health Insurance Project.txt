---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
Maintenance - 9168 - Inquire Star Health Policy Details (ISHP) - Done
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
Fields:
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
Bank Reference No                   Key Field

Customer ID                         Child Field
Customer Name                       Child Field
Customer Account No                 Child Field
Proposal Type                       Child Field		If starts from AA - Display Renewal else display New
Proposal Number                     Child Field
Transaction Date                    Child Field
Collection Amount                   Child Field
Status of Proposal                  Child Field
Customer Code                       Child Field
Policy Number                       Child Field
Policy Date                         Child Field
Sum Assured                         Child Field
Expiry Date                         Child Field
Reason, if pending/rejected         Child Field
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
Search:
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
Bank Reference No                   Display Columns - Bank Ref No and Customer Name
                                    Enable text based search
                                    Search to query on  
                                        Bank Ref No
                                        Customer ID
                                        Customer Name
                                        Customer Account No
                                        Proposal Number
                                        Bank Reference Number
                                        Customer Code
                                        Policy Number
                                    Search only on records related to the SOLID

---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
Logic:
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
1. While displaying data, display the data 

    From Customer ID to Collection Amount from STAR_HEALTH_MASTER table
    From Status of Proposal to Reason from STAR_HEALTH_POLICY_DETAILS table. In this table multiple records will exist. Fetch the data from the serial number.

---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
Tables:
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
DROP TABLE IF EXISTS STAR_HEALTH_MASTER;
CREATE TABLE STAR_HEALTH_MASTER
(
    SHM_TRAN_DATE           DATE,
    SHM_TRAN_ID             VARCHAR(9),
    SHM_SOL_ID              VARCHAR(8),
    SHM_CID                 VARCHAR(9),
    SHM_CNAME               VARCHAR(80),
    SHM_ACNO                VARCHAR(16),
    SHM_PROPOSAL_NO         VARCHAR(30),
    SHM_BANK_REF_NO         VARCHAR(20),
    SHM_TRAN_AMOUNT         DECIMAL(20,2),
    SHM_RECORD_STATUS       INT(2),
    SHM_UUSER               VARCHAR(15),
    SHM_UDATE               DATETIME
) COMMENT = 'To store the data of star health insurance policies retrieved from cbs';
CREATE INDEX STAR_HEALTH_MASTER_IDX1 ON STAR_HEALTH_MASTER (SHM_SOL_ID);
CREATE UNIQUE INDEX STAR_HEALTH_MASTER_IDX2 ON STAR_HEALTH_MASTER (SHM_TRAN_DATE,SHM_TRAN_ID);
CREATE INDEX STAR_HEALTH_MASTER_IDX3 ON STAR_HEALTH_MASTER (SHM_BANK_REF_NO);

DROP TABLE IF EXISTS STAR_HEALTH_POLICY_DETAILS;
CREATE TABLE STAR_HEALTH_POLICY_DETAILS
(
    SHPD_BANK_REF_NO        VARCHAR(20),
    SHDP_SERIAL_NO          INT(10),
    SHDP_UPLOAD_DATE        DATE,
    SHDP_CUSTOMER_CODE      VARCHAR(30),
    SHDP_POLICY_NO          VARCHAR(30),
    SHDP_POLICY_DATE        DATE,
    SHDP_SUM_ASSURED        DECIMAL(20,2),
    SHDP_EXPIRY_DATE        DATE,
    SHDP_PROPOSAL_STATUS    VARCHAR(1),
    SHDP_REMARKS            VARCHAR(100)
    SHDP_UUSER              VARCHAR(15),
    SHDP_UDATE              DATETIME
) COMMENT = 'To store the policy data provided by star health |SHDP_PROPOSAL_STATUS - P (Pending), I (Issued), R (Rejected)';

DELETE FROM PARAM_SEQUENCE WHERE SEQUENCE_NAME = 'SHDP_SERIAL_NO';
INSERT INTO PARAM_SEQUENCE(SEQUENCE_NAME, SEQUENCE_INCREMENT, SEQUENCE_MIN_VALUE, SEQUENCE_MAX_VALUE, SEQUENCE_CUR_VALUE, SEQUENCE_CYCLE) VALUES('SHDP_SERIAL_NO', 1, 1, 9999999999, 1, 0);
COMMIT;

DROP TABLE IF EXISTS STAR_HEALTH_SEARCH_INDEX;
CREATE TABLE STAR_HEALTH_SEARCH_INDEX
(
    SHSI_SOL_ID             VARCHAR(8),
    SHSI_BANK_REF_NO        VARCHAR(20),
    SHSI_SEARCH_KEYS        VARCHAR(30)
) COMMENT = 'To store the search keys to easily fetch the Bank Reference Number of Star Health Insurance Policies';
CREATE INDEX STAR_HEALTH_SEARCH_INDEX_IDX1 ON STAR_HEALTH_SEARCH_INDEX (SHSI_SOL_ID);
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
Report - 4214 - Star Health Policy Report (SHPR)  - Modification required (Proposal Status filter) - Done
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
	Filters:
		SOLID				    Allow SOLID and SOLSETs
		Bank Reference No		All/Specific
		Policy No			    All/Specific
		Customer ID			    All/Specific
		Account No			    All/Specific
		Enrollment Date From	01-01-1976
		Enrollment Date To		Current Date
        Proposal Status          All/Specific

        If proposal status is P, display records where the policy details are not update by star health + the policy details having the status pending

---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
Upload - 5017 - Star Health Policy Data Upload - Done           (INSERTING DETAILS INTO STAR HEALTH POLICY DETAILS TABLE)
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

File Format required from Star Health:

    First Line:

        Line No         ~
        5017            |
        Date of file    |
        No of records

    Second Line onwards:

        Line No         ~
        Bank Ref No     |
        Customer Code   |
        Policy No       |
        Policy Date     |   In dd-mm-yyyy format
        Sum Assured     |   
        Expiry Date     |
        Proposal Status |   I (Issued); R (Rejected); P (Pending)
        Reason              Mandatory if the proposal status is Pending/Rejected

    Specifications for data:

                


    Sample Format:

        1~5017|06-12-2017|3
        2~3000|abc|11|01-12-2017|200.00|12-12-2020|I|
        3~3001|abcD|12|01-12-2017|200.00|12-12-2017|R|Age Over

---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
Integration of SOLSET concept in CBS Annex  - Done - Move to Live - Done
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

    1. Create the tables solset master and sol set items
    2. Create the base solsets in solset master table
    3. Create a procedure to sync solset items from param sol master
    4. Create an event to run the above procedure on a daily basis (after completion of param sol master sync)

---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
Create a procedure to insert data to STAR_HEALTH_MASTER table:  - Done
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

    1. Procedure Name - STAR_HEALTH_MASTER_DATA_UPDATE
    2. Input - GDATA with data type CLOB
    3. Input data format

	5~FSDF|DFSD|DFD|DASFDS~
        No of Records           ~
        First Record            ~
        Second Record           ~
        .....

        Each record consists of the following fields:

            SHM_TRAN_DATE           |
            SHM_TRAN_ID             |
            SHM_SOL_ID              |
            SHM_CID                 |
            SHM_CNAME               |
            SHM_ACNO                |
            SHM_PROPOSAL_NO         |
            SHM_BANK_REF_NO         |
            SHM_TRAN_AMOUNT         |


    4. Make the basic validations on every element under each record. Also validate the number of records available and the number provided in the first input
    5. After successful validation, insert data to STAR_HEALTH_MASTER table. Update SYSTEM as the User ID.  If a record exists for the Tran Date and Tran ID, skip that record.

---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
EMail - XXXXX - Status of star health enrollment as on XXXXX = TRANSACTION DATE 
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

Columns:

    SOLID
    SOL Name
    Yesterday
        No. of customers
        Total Collection Amount
    This Month
        No. of customers
        Total Collection Amount
    This Quarter
        No. of customers
        Total Collection Amount
    This FY
        No. of customers
        Total Collection Amount
    Since Inception
        No. of customers
        Total Collection Amount

Rows:

    Bank as a whole

    Regional Office Wise

    District Wise

    SOL Wise

Type of Mail:

    Bank as a Whole
    Regional Office Wise

Suggested Format:

    PGRS Complaint Status - Detailed Report as on 06-12-2017(KGB)

Send To:

    Bank as a whole - Chairman, All GMs, PD Wing, IT Wing, MIS Team
    Regional Office - Concerned Regional Office Official eMail ID

---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
EMail - XXXXX - Policies Pending for update from Star Health Insurance 
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

Columns:

    Transaction Date - is it current date
    No. of Policies

Suggested Format:

    PGRS Complaint Status - Detailed Report as on 06-12-2017(KGB)

Send To:

    Bank as a whole - Chairman, All GMs, PD Wing, IT Wing, MIS Team

Logic:

    1. Entries lying in Master table but no entry exist in policy table
    2. Entries lying in Master table but the status of the policy is pending

---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
SMS - XXXXX - Star Health Policy Enrollment: -- TRAN DATE
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
Star Health Policy Enrollment Status as on XX-XX-XXXX:
(Premium Amount/No)

Yesterday : XXXXX (X)
Month : XXXXX (X)
Quarter : XXXXX (X)
Fin Year : XXXXX (X)
Since Inception : XXXXX (X)

CBS Annexe Module

Type of SMS:

    Bank as a Whole
    Regional Office Wise

Send To:

    Bank as a whole - Chairman, All GMs, PD Wing, IT Wing, MIS Team
    Regional Office - Concerned Regional Office Official eMail ID

---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
Procedure to build Star Health Search Key Directory - Done
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

    1. Procedure Name - STAR_HEALTH_BUILD_KEYWORD
    2. Input - Bank Reference No (All/Specific)
    3. To store the key word data to enable search in Star Health Maintenance
    4. Include it in an event to run the same on a daily basis. Call this procedure after the event which calls the procedure to update data from Finacle

---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
Call Data from Finacle 
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

    1. Write a console application to call the web service in Finacle Connector Server, which fetch the data from Finacle. The aspects to be managed here: (DONE)

            a. Call the Finacle Connecter Web service
            b. Get the output from the web service
            c. Call procedure STAR_HEALTH_MASTER_DATA_UPDATE by passing the output recieved from Finacle

    2. Create a scheduler in CBS Annexure server to call the console application every day.

---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
Procedure to be created in Finacle:
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

    Deepu to do

---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
Create an entry in Finacle Connecter Web Service:
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------




---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------